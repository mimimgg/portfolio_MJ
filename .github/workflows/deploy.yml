# .github/workflows/deploy.yml (PORTFOLIO_MJ 저장소의 루트에 생성)

name: Deploy React App from Subdirectory to GitHub Pages # 워크플로우 이름

on:
  push:
    branches:
      - main # main 브랜치에 푸시될 때 워크플로우 실행 (혹은 master)

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest # 빌드 환경 설정 (리눅스 가상 머신)

    steps:
      - name: Checkout code # 1. 저장소 코드 가져오기
        uses: actions/checkout@v4

      - name: Set up Node.js # 2. Node.js 환경 설정
        uses: actions/setup-node@v4
        with:
          node-version: '18' # 프로젝트에 맞는 Node.js 버전으로 설정 (권장 16.x 또는 18.x)

      # --- React 앱 폴더로 이동하여 작업 수행 ---
      - name: Install dependencies # 3. React 앱의 의존성 설치
        run: npm install
        working-directory: portfolio-mj-react # 이 단계는 'portfolio-mj-react' 폴더 안에서 실행됩니다.

      - name: Build React app # 4. React 앱 빌드 (npm run build)
        run: npm run build
        working-directory: portfolio-mj-react # 이 단계도 'portfolio-mj-react' 폴더 안에서 실행됩니다.

      - name: Deploy to GitHub Pages # 5. 빌드된 앱을 GitHub Pages에 배포
        uses: peaceiris/actions-gh-pages@v3 # GitHub Pages 배포를 위한 액션
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }} # GitHub 토큰 (자동 생성)
          publish_dir: ./portfolio-mj-react/build # ⭐ 빌드된 React 앱의 경로를 정확히 지정합니다.
          publish_branch: gh-pages # 배포할 브랜치 (GitHub Pages 설정에 따라)
          # cname: your-custom-domain.com # 커스텀 도메인을 사용한다면 주석 해제